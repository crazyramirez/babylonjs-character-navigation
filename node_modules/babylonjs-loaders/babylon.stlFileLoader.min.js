!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-loaders",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-loaders"]=t(require("babylonjs")):e.LOADERS=t(e.BABYLON)}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,(e=>(()=>{"use strict";var t={520:t=>{t.exports=e}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{n.d(o,{default:()=>l});var e={};n.r(e),n.d(e,{STLFileLoader:()=>i});var t={};n.r(t),n.d(t,{STLFileLoader:()=>i});var r=n(520),i=function(){function e(){this.solidPattern=/solid (\S*)([\S\s]*?)endsolid[ ]*(\S*)/g,this.facetsPattern=/facet([\s\S]*?)endfacet/g,this.normalPattern=/normal[\s]+([-+]?[0-9]+\.?[0-9]*([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+/g,this.vertexPattern=/vertex[\s]+([-+]?[0-9]+\.?[0-9]*([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+/g,this.name="stl",this.extensions={".stl":{isBinary:!0}}}return e.prototype.importMesh=function(e,t,n,o,i){var a;if("string"!=typeof n){if(this._isBinary(n)){var s=new r.Mesh("stlmesh",t);return this._parseBinary(s,n),i&&i.push(s),!0}for(var l=new Uint8Array(n),f="",u=0;u<n.byteLength;u++)f+=String.fromCharCode(l[u]);n=f}for(;a=this.solidPattern.exec(n);){var d=a[1],p=a[3];if(p&&d!=p)return r.Tools.Error("Error in STL, solid name != endsolid name"),!1;if(e&&d)if(e instanceof Array){if(!e.indexOf(d))continue}else if(d!==e)continue;d=d||"stlmesh",s=new r.Mesh(d,t),this._parseASCII(s,a[2]),i&&i.push(s)}return!0},e.prototype.load=function(e,t,r){return this.importMesh(null,e,t,r,null)},e.prototype.loadAssetContainer=function(e,t,n){var o=new r.AssetContainer(e);return e._blockEntityCollection=!0,this.importMesh(null,e,t,n,o.meshes),e._blockEntityCollection=!1,o},e.prototype._isBinary=function(e){var t=new DataView(e);if(t.byteLength<=80)return!1;if(84+50*t.getUint32(80,!0)===t.byteLength)return!0;for(var r=[115,111,108,105,100],n=0;n<5;n++)if(t.getUint8(n)!==r[n])return!0;return!1},e.prototype._parseBinary=function(t,n){for(var o=new DataView(n),i=o.getUint32(80,!0),a=0,s=new Float32Array(3*i*3),l=new Float32Array(3*i*3),f=new Uint32Array(3*i),u=0,d=0;d<i;d++){for(var p=84+50*d,c=o.getFloat32(p,!0),y=o.getFloat32(p+4,!0),h=o.getFloat32(p+8,!0),b=1;b<=3;b++){var g=p+12*b;s[a]=o.getFloat32(g,!0),l[a]=c,e.DO_NOT_ALTER_FILE_COORDINATES?(s[a+1]=o.getFloat32(g+4,!0),s[a+2]=o.getFloat32(g+8,!0),l[a+1]=y,l[a+2]=h):(s[a+2]=o.getFloat32(g+4,!0),s[a+1]=o.getFloat32(g+8,!0),l[a+2]=y,l[a+1]=h),a+=3}e.DO_NOT_ALTER_FILE_COORDINATES?(f[u]=u,f[u+1]=u+2,f[u+2]=u+1,u+=3):(f[u]=u++,f[u]=u++,f[u]=u++)}t.setVerticesData(r.VertexBuffer.PositionKind,s),t.setVerticesData(r.VertexBuffer.NormalKind,l),t.setIndices(f),t.computeWorldMatrix(!0)},e.prototype._parseASCII=function(t,n){for(var o,i=[],a=[],s=[],l=0;o=this.facetsPattern.exec(n);){var f=o[1],u=this.normalPattern.exec(f);if(this.normalPattern.lastIndex=0,u){for(var d=[Number(u[1]),Number(u[5]),Number(u[3])],p=void 0;p=this.vertexPattern.exec(f);)e.DO_NOT_ALTER_FILE_COORDINATES?(i.push(Number(p[1]),Number(p[3]),Number(p[5])),a.push(d[0],d[2],d[1])):(i.push(Number(p[1]),Number(p[5]),Number(p[3])),a.push(d[0],d[1],d[2]));e.DO_NOT_ALTER_FILE_COORDINATES?(s.push(l,l+2,l+1),l+=3):s.push(l++,l++,l++),this.vertexPattern.lastIndex=0}}this.facetsPattern.lastIndex=0,t.setVerticesData(r.VertexBuffer.PositionKind,i),t.setVerticesData(r.VertexBuffer.NormalKind,a),t.setIndices(s),t.computeWorldMatrix(!0)},e.DO_NOT_ALTER_FILE_COORDINATES=!1,e}();r.SceneLoader&&r.SceneLoader.RegisterPlugin(new i);var a=void 0!==n.g?n.g:"undefined"!=typeof window?window:void 0;if(void 0!==a)for(var s in e)a.BABYLON[s]||(a.BABYLON[s]=e[s]);const l=t})(),o.default})()));
//# sourceMappingURL=babylon.stlFileLoader.min.js.map